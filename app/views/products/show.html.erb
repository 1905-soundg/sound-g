<% if user_signed_in? %>

<div class="container">
	<div class="row">
    <div class="col-xs-1">
    </div>

		<div class="col-xs-6" >
      <div style="margin: 40px">
        <%= attachment_image_tag @product,:image, :fill,400,400 %>
      </div>
		</div>

   	 <div class="col-xs-4" style="margin-top: 40px">


   		<div >
      <p class="" style="margin: 0 0 0 0;"> <%= @genre.genre %> </p>
   		<h2 class="" style="margin: 15px 0 15px 0;"> <%= @product.album %> </h2>
   		<p class="" style="margin: 10px 0 10px 0;"> <%= @label.label %></p>
   		<p class="" style="margin: 10px 0 10px 0;"> ¥<%= @product.price %></p>
      <% if @product.favorited_by?(current_user) %>
          <%= link_to product_favorites_path(@product), method: :delete do %>
            <i class="glyphicon glyphicon-heart" aria-hidden="true" style="color: red;"></i>
            <%= @product.favorites.count %>
          <% end %>
      <% else %>
          <%= link_to product_favorites_path(@product), method: :post do %>
            <i class="glyphicon glyphicon-heart" aria-hidden="true"></i>
            <%= @product.favorites.count %>
          <% end %>
      <% end %>
      </div>

   		<div style="margin: 10px 0px">
      <%= form_for @cart, url:user_carts_path(user_id: current_user.id) do |f| %>
         <div class="col-xs-2" style="padding: 0 0 0 0;" >
       		<%= f.number_field :quantity, min: 0, max: @product.stock_quantity, class: "form-control", style: "width: 80px;" %>
         </div>
         <div class="col-xs-2" style="padding: 0 0 0 0;">
       		<%= f.hidden_field :product_id, :value => @product.id %>
         </div>
   		<%= f.submit "カートに追加", class: "btn btn-default" %>
      </div>
   		<% end %>

               <% @discs.each do |d| %>
               <div class="d-inline-block col-xs-5">
                 <ul class="list-unstyled">
                   <li>
                    ディスクNo.<%= d.disc_number %>
                   </li>
                    <% d.musics.each do |m| %>
                   <li>
                    <%= m.title %>
                   </li>
                   <% end %>
								 </ul>
               </div>
               <% end %>

    <div class="col-xs-1">
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-10 col-md-offset-1" >
  <div class="d-center-block">
      <%= form_for (@review) do |f| %>
				<h3>商品レビュー</h3>

				<%= f.text_area :review, :size => "130x5",  class: "form-control", placeholder:"新規レビュー投稿" %>
				<%= f.hidden_field :product_id, :value => @product.id %>
				<%= f.submit "投稿", class: "btn btn-default", style: "margin-top: 10px;" %>
				<% end %>
        <%= render 'reviews/reviews' %>
  </div>
  </div>
</div>


<% else %>
<%= render 'layouts/header' %>
<div class="container">
  <div class="row">
    <div class="col-xs-1">
    </div>

    <div class="col-xs-6" >
      <div style="margin: 40px">
        <%= attachment_image_tag @product,:image, :fill,400,400 %>
      </div>
    </div>

     <div class="col-xs-4" style="margin-top: 40px">


      <div>
      <p> <%= @genre.genre %> </p>
      <h2> <%= @product.album %> </h2>
      <p> <%= @label.label %></p>
      <p> ¥<%= @product.price %> </p>
      <i class="glyphicon glyphicon-heart" aria-hidden="true" style="color: red;"></i>
      <%= @product.favorites.count %>
      </div>

      <div style="margin: 10px 0px">
        <div class="col-xs-6" style="padding: 0 0 0 0;" >
        <%= number_field :quantity, min: 0, max: @product.stock_quantity, class: "form-control", style: "width: 80px;" %>
        </div>
        <div class="col-xs-6" style="padding: 0 0 0 0;" >
          <%= link_to "カートに追加", new_user_session_path, aria_hidden: "true", class: "btn btn-default" %>
        </div>
      </div>

      <div class="col-xs-12" >
               <% @discs.each do |d| %>
               <div class="d-inline-block col-xs-5">
                 <ul class="list-unstyled">
                     <li>
                        ディスクNo.<%= d.disc_number %>
                     </li>
                     <% d.musics.each do |m| %>
                     <li>
                        <%= m.title %>
                     </li>
                     <% end %>
                 </ul>
               </div>
               <% end %>
      </div>

      </div>
      <div class="col-xs-1">
     </div>
</div>



<div class="row">
  <div class="col-md-10 col-md-offset-1" >
  <div class="d-center-block">
        <h3>商品レビュー</h3>

        <%= render 'reviews/reviews' %>

      </div>
    </div>
</div>

<% end %>
